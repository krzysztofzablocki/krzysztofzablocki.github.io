<!DOCTYPE html>
<html xmlns:og="http://ogp.me/ns#" xmlns:fb="http://www.facebook.com/2008/fbml">
<head>
  <title>Krzysztof ZabÅ‚ocki - Hot Reloading in Swift</title>
  <link href="http://gmpg.org/xfn/11" rel="profile">
<meta http-equiv="content-type" content="text/html; charset=utf-8">


<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="description" content="What if you didn&#39;t need to waste time waiting for your Swift projects to recompile? Does saving 10h per week sounds good?">

<meta name="author" content="Krzysztof ZabÅ‚ocki">


<meta property="og:title" content="Hot Reloading in Swift" />
<meta property="og:description" content="What if you didn&#39;t need to waste time waiting for your Swift projects to recompile? Does saving 10h per week sounds good?" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.merowing.info/2022/04/hot-reloading-in-swift/" />

<meta property="og:image" content="http://merowing.info/2022/hot-reloading.jpg" />



<meta property="og:updated_time" content="2022-04-01 00:00:00 &#43;0000 UTC"/>


<meta property="og:site_name" content="Krzysztof ZabÅ‚ocki" />







<meta property="article:author" content="https://www.facebook.com/krzysztof.zablocki" />
<meta property="article:publisher" content="https://www.facebook.com/krzysztof.zablocki" />
<meta property="article:published_time" content="2022-04-01 00:00:00 &#43;0000 UTC" />
<meta property="article:section" content="post" />

<meta property="article:tag" content="Engineering" />

<meta property="article:tag" content="Open Source" />

<meta property="article:tag" content="Tools" />

<meta property="article:tag" content="Workflow" />


<meta property="fb:app_id" content="406961899319006" />


<meta itemprop="name" content="Hot Reloading in Swift">
<meta itemprop="description" content="What if you didn&#39;t need to waste time waiting for your Swift projects to recompile? Does saving 10h per week sounds good?">



<meta itemprop="image" content="http://merowing.info/2022/hot-reloading.jpg">



<meta itemprop="keywords" content="animation,animations,architecture,clean-code,development-process,engineering,experiments,fitness,gamedev,general,growth,interface-builder,ios,ios-tips,leading,library,mindset,mvvm,open-source,process,psychology,reading,ruby,runtime,script,swift,tip,tools,tutorial,uix,workflow," />


<meta itemprop="wordCount" content="1648">



<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image:src" content="http://merowing.info/2022/hot-reloading.jpg"/>



<meta name="twitter:title" content="Hot Reloading in Swift"/>
<meta name="twitter:description" content="What if you didn&#39;t need to waste time waiting for your Swift projects to recompile? Does saving 10h per week sounds good?"/>
<meta name="twitter:site" content="@merowing_"/>
<meta name="twitter:creator" content="@merowing_"/>



  <link rel="canonical" href="https://www.merowing.info/2022/04/hot-reloading-in-swift/">

  <link href='//fonts.googleapis.com/css?family=Merriweather:900,900italic,300,300italic' rel='stylesheet' type='text/css'>
  <link href='//fonts.googleapis.com/css?family=Lato:900,300' rel='stylesheet' type='text/css'>
  <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css" rel="stylesheet">


  
  <link href="/css/prism.css" rel="stylesheet" />
  <link href="/css/about.css" rel="stylesheet" />

  <link rel="stylesheet" type="text/css" href="https://www.merowing.info/css/combined-min.css">
</head>
<body class="">

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js" type="text/javascript"></script>
<div class="site-wrap">
    <header class="site-header px2 px-responsive">
    <div class="mt2 wrap">
        <div class="measure">
            <nav class="site-nav left">
                <a href="https://www.merowing.info" class="site-title"><b>About</b></a>
            </nav>
            <nav class="site-nav right">
                <a href="/post/">Blog</a>

<a href="/speaking/">Speaking</a>
<a href="/sourcery-pro/">Sourcery Pro</a>


</form>
            </nav>
            <div class="clearfix"></div>
        </div>
    </div>
</header>

<div class="wrap measure center">
    <nav class="social-icons icons">
        
<a class="fa fa-twitter" href="https://twitter.com/merowing_"></a>



<a class="fa fa-github" href="https://github.com/krzysztofzablocki"></a>



<a class="fa fa-facebook" href="https://facebook.com/krzysztofzablocki"></a>



<a class="fa fa-linkedin" href="https://linkedin.com/pub/krzysztof-zab%c5%82ocki/26/200/442"></a>


<a class="fa fa-rss" href="/index.xml"></a>

    </nav>
</div>
    <div class="post p2 p-responsive wrap" role="main">
        <div class="measure">
            <div class="post-header mb2">
                <h1 class="h2 py2">Hot Reloading in Swift</h1>
                
                <span class="post-meta right"><i class="fa fa-clock-o"></i> <em>8 minute read</em></span>
                
                <br>

                
            </div>

            

            
            <div class="center playground">
                <a href="https://github.com/krzysztofzablocki/Inject">
                    <img src="https://www.merowing.info/2015/01/github.jpg" />
                    <span>Source Code on GitHub.</span>
                </a>
            </div>
            <br />
            

            <article class="post-content">
                <figure class="center">
    
        <img src="/2022/hot-reloading.jpg"  />
    
    
</figure>



<p>The year is 2040, our newest MacBook M30X processors can compile large Swift projects perceivably instantaneously, sounds pretty amazing right?</p>

<p>Except, compiling codebase is just part of our iteration cycle, there are other ones like restarting it (or deploying to the device), re-navigate to the previous location where you were in the app itself, re-produce the data you need.</p>

<p>Doesnâ€™t sound bad if you have to do it once, but what if you are like me and on a usual day do between <strong>200 - 500</strong> iterations on the codebase? It adds up.</p>

<p>There is a better way, embraced by other platforms but also achievable in the Swift/iOS ecosystem. <strong>Iâ€™ve used it for over a decade.</strong></p>

<p><strong>Do you want to save up to 10h work per week, starting today?</strong></p>

<p></p>

<h3 id="hot-reloading">Hot Reloading</h3>

<p>Hot reloading is about getting rid of compiling your whole application and avoiding deploy/restart cycles as much as possible, all while allowing you to edit your running application code and see changes reflected as close as possible to real-time.</p>

<p>This makes you significantly more productive by reducing the time you spend waiting for apps to rebuild, restart, re-navigate to the previous location where you were in the app itself, and re-produce the data you need.</p>

<p>This can save you literal hours off development time, <strong>each day</strong>.
I tracked my work for over a month and for me it was between 1-2h <strong>each day</strong>.</p>

<p><strong>Frankly, If saving up to 10h of development time per week doesnâ€™t convince you to give this a try, I donâ€™t think anything will.</strong></p>

<h3 id="what-other-platforms-are-doing">What other platforms are doing?</h3>

<p>If you were stuck in Apple platforms for a while it can be quite surprising how many platforms and stacks have embraced hot-reloading decades ago, whether you write Node or any other JS framework there is a setup for you to use hot-reloading. Go also offers hot-reloading (thatâ€™s actually how my blog is written).</p>

<p>Even more so Googleâ€™s Flutter architecture is designed to work with hot-reloading, in-fact if you talk to engineers working on Flutter being able to live code their applications is one of the things they love the most about Flutter developer experience, I loved it when I was writing a spelling bee game for The New York Times.</p>

<p>Microsoft recently <a href="https://devblogs.microsoft.com/visualstudio/visual-studio-2022-now-available/">launched Visual Studio 2022</a> and it offers hot-reloading for both <code>.NET</code> and normal <code>C++</code> applications. Microsoft has been killing it ðŸ‘Œ over the last decade when it comes to dev tooling and experience so not a big surprise.</p>

<h3 id="what-about-apple-ecosystem">What about Apple ecosystem?</h3>

<p>Back in 2014 when it launched, a lot of people were in awe of Swift Playgrounds since they allowed us to quickly iterate and see the results of our code, except they didnâ€™t work very well because it crashed, hanged, didnâ€™t support full iPad environment.</p>

<p>Very shortly after they were released, Iâ€™ve launched an open-source project called Objective-C Playgrounds that worked much faster and more reliably than official playgrounds, this was really an architecture/workflow setup project that was built on top of <a href="https://github.com/DyCI/dyci-main">DyCI</a> code injection tool Iâ€™ve been using for a few years already made by <a href="https://twitter.com/TT_Kilew">Paul</a>.</p>

<p>7 years have passed since, Swift Playgrounds are still here and they got better, but are they reliable? Are people using them to drive their development?</p>

<blockquote>
<p><em>In my experience: not really, they tend to not be very reliable or applicable in bigger projects.</em></p>
</blockquote>

<p>SwiftUI came along and itâ€™s an amazing piece of technology (<strong>albeit still buggy</strong>), it introduced the idea of Swift Previews that are very similar to Playgrounds, are they any good?</p>

<p>Similar story, they are great when they work but they are quite unreliable in bigger projects and tend to break more times than they work, they donâ€™t offer you the ability to properly debug the code if you have any errors and as such the adoption yet again has been limited in what I could see in teams I consulted with.</p>

<h3 id="do-we-need-to-wait-for-apple">Do we need to wait for Apple?</h3>

<p>If you followed me for a while you already know the answer, <strong>ABSOLUTELY NO</strong>. After all, I made a career out of building things that vanilla Apple solutions donâ€™t solve: from language extensions like <a href="https://github.com/krzysztofzablocki/Sourcery">Sourcery</a>, Xcode improvements like <a href="http://merowing.info/sourcery-pro/">Sourcery Pro</a> through <a href="https://github.com/krzysztofzablocki/LifetimeTracker">LifetimeTracker</a> and <a href="https://github.com/krzysztofzablocki">many others</a> open-source tools.</p>

<p>We can leverage the same approach Iâ€™ve originally used in my 2014 Playgrounds. Iâ€™ve been leveraging it for <strong>over a decade</strong> and Iâ€™ve used it with huge success in tens of Swift Projects!</p>

<p>Many years ago I switched from using <a href="https://github.com/DyCI/dyci-main">DyCI</a> to <a href="https://github.com/johnno1962/InjectionIII">InjectionForXcode</a> which works even better by leveraging LLVM inter-op rather than any kind of swizzling.
Itâ€™s a completely free open-source tool that you simply run in your menu bar and itâ€™s made by the prolific engineer <a href="https://twitter.com/Injection4Xcode">John Holdsworth</a>, you should <a href="http://books.apple.com/us/book/id1551005489">check out his book Swift Secrets</a>.</p>

<p>I recognized that <a href="https://github.com/krzysztofzablocki/Playgrounds">Playgrounds</a> approach might have been too heavy-handed, so today Iâ€™m open-sourcing a very focused micro-library called <a href="https://github.com/krzysztofzablocki/Inject">Inject</a> that when paired with <a href="https://github.com/johnno1962/InjectionIII"> InjectionForXcode</a> will make your Apple development much more efficient and enjoyable!</p>

<p>But donâ€™t trust just my word for it, look at the feedback from Alexandra and Nate who were already extremely proficient before I even introduced this workflow into <a href="https://thebrowser.company">The Browser Company</a> setup, which makes it even more impressive.</p>


<figure class="center">
    
        <img src="/2022/Feedback.png"  />
    
    
</figure>



<h2 id="inject">Inject</h2>

<p>This small library is completely universal, whether you work with <code>UIKit</code>, <code>AppKit</code> or <code>SwiftUI</code>, you are going to be able to leverage it.</p>

<p>You donâ€™t need to add conditional compilation or remove <code>Inject</code> code from your applications for production, it turns into no-op inlined code that will get stripped by the compiling process in non-debug builds. You can integrate it once per view and keep using it for years.</p>

<p>Refer to <a href="https://github.com/krzysztofzablocki/Inject">GitHub repo</a> for instructions on how to configure your project. Now letâ€™s look at workflow options you can leverage it at.</p>

<h3 id="workflows">Workflows</h3>

<h4 id="swiftui"><strong>SwiftUI</strong></h4>

<p>There are <strong>only 2 lines</strong> required to make any SwiftUI enabled for live programming, and the moment you do that you have a faster workflow than you did with Swift Previews, while being able to use real production data.</p>

<p>Hereâ€™s an example of my <a href="http://merowing.info/sourcery-pro/">Sourcery Pro</a> app loaded with my all real data and logic, allowing me to quickly iterate on the whole app design instantaneous without any restarts, reloads, or anything like that.</p>

<p>Just look how fast this development workflow is :mind-blown: and tell me youâ€™d rather wait for Xcode re-builds and re-deployment each time Iâ€™m touching the code.</p>

<video autoplay loop>
  <source src="/2022/Inject-SourceryPro.mp4" type="video/mp4">
</video>

<blockquote>
<p>These 2 lines donâ€™t even need to be removed, since they are no-op in Release builds. So once added they can be kept in your repo forever.</p>
</blockquote>

<h4 id="uikit-appkit"><strong>UIKit / AppKit</strong></h4>

<p>For standard imperative UI frameworks, we need a way to clean up the state between code injection phases.</p>

<p>I create the concept of <strong>Hosts</strong> that work really well in that context, there are 2:</p>

<pre><code class="language-swift">- Inject.ViewHost
- Inject.ViewControllerHost
</code></pre>

<p>How do we integrate this? We wrap the class we want to iterate on at the parent level, so we donâ€™t modify the class we want to be injecting but we modify the parent call site.</p>

<p>Eg. If you have a <code>SplitViewController</code> that creates <code>PaneA</code> and <code>PaneB</code>, and you want to iterate on layout/logic code in <code>PaneA</code>, you modify the call site in <code>SplitViewController</code>:</p>

<pre><code class="language-swift">paneA = Inject.ViewHost(
  PaneAView(whatever: arguments, you: want)
)
</code></pre>

<p>That is all the changes you need to do, your app now allows you to change anything in <code>PaneAView</code> except for its initializer API, and the changes will be almost immediately reflected in your App.</p>

<hr />

<p>A more specific example?</p>

<ul>
<li>I downloaded <a href="https://github.com/dkhamsing/covid19.swift">Covid19 App</a></li>
<li>Added <code>-Xlinker -interposable</code> to <code>Other Linker Flags</code></li>
<li>Swapped a single line <code>Covid19TabController.swift:L63</code> line</li>
</ul>

<p>from:</p>

<pre><code class="language-swift">let vc = TwitterViewController(title: Tab.twitter.name, usernames: Twitter.content)
</code></pre>

<p>to:</p>

<pre><code class="language-swift">let vc = Inject.ViewControllerHost(TwitterViewController(title: Tab.twitter.name, usernames: Twitter.content))
</code></pre>

<p>And now I can iterate over the controller design without any restarts of the app:</p>

<video autoplay loop>
  <source src="/2022/Inject-Covid19.mp4" type="video/mp4">
</video>

<h4 id="how-does-this-work-underneath">How does this work underneath?</h4>

<p>Hosts leverage auto-closure so each time you inject code we create a new instance of your type with the same arguments as it had originally, allowing you to iterate on any code, memory layout, and everything else, the only thing that you canâ€™t change is your initializer API.</p>

<blockquote>
<p><em>Host changes canâ€™t be fully inlined, so those classes are removed in release builds, to accommodate for that inconvenience the easiest way is to simply make a separate commit that swaps this one-liner and then remove it at the end of your workflow.</em></p>
</blockquote>

<h3 id="what-about-logic-injection">What about logic injection?</h3>

<p>Standard architectures like MVVM / MVC get a free logic injection, just recompile your classes and when the methods are called again youâ€™ll already be using new code.</p>

<p>If like myself you love <a href="https://github.com/pointfreeco/swift-composable-architecture">PointFree Composable Architecture</a>, youâ€™d probably want to inject reducer code, this isnâ€™t possible in vanilla TCA because reducer code is a free function which isnâ€™t as straightforward to replace with injection, but [our fork at The Browser Company] supports it.</p>

<p>When I originally started consulting with TBC, the first thing I wanted was to integrate <code>Inject</code> and <code>XcodeInjection</code> into our workflow, the company management was very supportive.</p>

<p>I was able to get <a href="https://twitter.com/Injection4Xcode">John Holdsworth</a> to consult with <a href="https://thebrowser.company">us</a> to help improve the tool a bit and built-in injection support for TCA architecture. <a href="https://twitter.com/Injection4Xcode">John</a> blew our mind with how fast he was able to execute the idea and deliver stable support for reducer injection, it works extremely reliable.</p>

<p>If you switch to <a href="(https://github.com/thebrowsercompany/swift-composable-architecture/tree/develop)">our fork of TCA</a> (which we keep up-to-date), you can leverage <code>Inject</code> across both UI and TCA layers.</p>

<h3 id="how-reliable-is-it">How reliable is it?</h3>

<p>Nothing is perfect but <strong>Iâ€™ve been using it for over a decade now</strong>, itâ€™s far more reliable than either of Apple tech (Playgrounds / Previews).</p>

<p>If you invest time into learning it, itâ€™s going to save you and your team thousands of hours!</p>

<h2 id="what-do-you-think">What do you think?</h2>

<p>If you&rsquo;d like to work with powerful workflows like this, you can join our mission of building a better way to use the internet <a href="https://thebrowser.company/careers">join us.</a></p>

<p><a href="https://github.com/krzysztofzablocki/Inject">Grab the project on GitHub</a></p>

<p>Let me know what you think on twitter:</p>
            </article>
            <a href="https://twitter.com/merowing_" class="twitter-follow-button" data-show-count="true"
                data-size="medium"></a>
            <br />
            <br />
            <hr>
            <a href="https://merowing.info/sourcery-pro/" class="p">
                If you hate writing repetitive code <b>SourceryPro</b> is here.
            </a>
            <p>
                Want to optimize your development workflow?
                <a href="mailto:krzysztof.zablocki@pixle.pl?Subject=I%20want%20to%20hire%20you" class="p">I'd love to
                    help your
                    team.
            </p>
            <div class="social-icons">
                <p>Share this post:</p>
                <div class="addthis_sharing_toolbox left" data-url="https://www.merowing.info/2022/04/hot-reloading-in-swift/" data-title="Hot Reloading in Swift"></div>
            </div>
            <div class="clearfix"></div>

            </br>
            
            </br>
            </br>

            <p class="post-meta">tags:&nbsp;
                
                
                <a href="https://www.merowing.info/tags/engineering">Engineering</a>
                
                ,&nbsp;
                <a href="https://www.merowing.info/tags/open%20source">Open Source</a>
                
                ,&nbsp;
                <a href="https://www.merowing.info/tags/tools">Tools</a>
                
                ,&nbsp;
                <a href="https://www.merowing.info/tags/workflow">Workflow</a>
                
            </p>
        </div>
    </div>
</div>

<script>!function (d, s, id) {
        var js, fjs = d.getElementsByTagName(s)[0];
        if (!d.getElementById(id)) {
            js = d.createElement(s);
            js.id = id;
            js.src = "//platform.twitter.com/widgets.js";
            fjs.parentNode.insertBefore(js, fjs);
        }
    }(document, "script", "twitter-wjs");</script>





<footer class="footer">
    <div class="p2 wrap">
        <div class="measure mt1 center">
            <nav class="social-icons icons">
    
<a class="fa fa-twitter" href="https://twitter.com/merowing_"></a>



<a class="fa fa-github" href="https://github.com/krzysztofzablocki"></a>



<a class="fa fa-facebook" href="https://facebook.com/krzysztofzablocki"></a>



<a class="fa fa-linkedin" href="https://linkedin.com/pub/krzysztof-zab%c5%82ocki/26/200/442"></a>


<a class="fa fa-rss" href="/index.xml"></a>

</nav>

            <small>
                Krzysztof ZabÅ‚ocki <br/>
                Copyright &#169; 2012-2021<br>
                Powered by <a href="http://gohugo.io/" target="_blank">Hugo</a> &amp; based on <a
                    href="https://github.com/azmelanar/hugo-theme-pixyll" target="_blank">Pixyll</a>
            </small>
        </div>
    </div>
</footer>

<script src="/js/prism.js"></script>
<script src="/js/carousel.js"></script>




<script src="/lightgallery/js/lightgallery.min.js"></script>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-mousewheel/3.1.13/jquery.mousewheel.min.js"></script>


<script src="/lightgallery/js/lg-thumbnail.min.js"></script>
<script src="/lightgallery/js/lg-fullscreen.min.js"></script>

<script type="text/javascript">
    $(document).ready(function () {
        $('.lightgallery').lightGallery({
            thumbnail: true
        });
    });
</script>



<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-29400340-1', 'auto');
  ga('send', 'pageview');

</script>



<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-532368630eb37492" async="async"></script>
<script type="text/javascript">
var addthis_share = addthis_share || {}
addthis_share = {
	passthrough : {
		twitter: {
			via: "merowing_"
		}
	}
}
</script>
</body>
</html>
