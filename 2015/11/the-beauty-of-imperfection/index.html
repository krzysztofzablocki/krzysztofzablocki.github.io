<!DOCTYPE html>
<html xmlns:og="http://ogp.me/ns#" xmlns:fb="http://www.facebook.com/2008/fbml">
<head>
  <title>The beauty of imperfection - Krzysztof Zabłocki</title>
  <link href="http://gmpg.org/xfn/11" rel="profile">
<meta http-equiv="content-type" content="text/html; charset=utf-8">


<meta name="viewport" content="width=device-width, initial-scale=1">



<meta name="author" content="Krzysztof Zabłocki">


<meta property="og:title" content="The beauty of imperfection" />
<meta property="og:description" content="
  


Perfection is not something one can truly achieve, so it’s very smart that one of the best meditation services called Headspace is using an imperfect dot as their brand logo.

If you ever used their iOS app, you can notice how their dot slightly deforms, captivating your focus.

When it comes to graphics, if you are able to cheat (if user can’t tell the difference) and make tech stuff easier, just do it.
" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://merowing.info/2015/11/the-beauty-of-imperfection/" />

<meta property="og:image" content="http://merowing.info/2015/12/dot-animated.gif" />



<meta property="og:updated_time" content="2015-11-24 12:29:37 &#43;0100 &#43;0100"/>


<meta property="og:site_name" content="Krzysztof Zabłocki" />

<meta property="og:video" content="http://merowing.info/2015/12/dot-animated.mov" />







<meta property="article:author" content="https://www.facebook.com/krzysztof.zablocki" />
<meta property="article:publisher" content="https://www.facebook.com/krzysztof.zablocki" />
<meta property="article:published_time" content="2015-11-24 12:29:37 &#43;0100 &#43;0100" />
<meta property="article:section" content="post" />

<meta property="article:tag" content="iOS" />

<meta property="article:tag" content="Tutorial" />

<meta property="article:tag" content="Experiments" />

<meta property="article:tag" content="UIX" />

<meta property="article:tag" content="Animation" />


<meta property="fb:app_id" content="406961899319006" />


<meta itemprop="name" content="The beauty of imperfection">
<meta itemprop="description" content="
  


Perfection is not something one can truly achieve, so it’s very smart that one of the best meditation services called Headspace is using an imperfect dot as their brand logo.

If you ever used their iOS app, you can notice how their dot slightly deforms, captivating your focus.

When it comes to graphics, if you are able to cheat (if user can’t tell the difference) and make tech stuff easier, just do it.
">



<meta itemprop="image" content="http://merowing.info/2015/12/dot-animated.gif">



<meta itemprop="keywords" content="animation,animations,architecture,clean-code,development-process,experiments,fitness,gamedev,general,interface-builder,ios,ios-tips,library,mindset,mvvm,open-source,process,psychology,reading,ruby,runtime,script,swift,tip,tools,tutorial,uix," />


<meta itemprop="wordCount" content="801">



<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image:src" content="http://merowing.info/2015/12/dot-animated.gif"/>



<meta name="twitter:title" content="The beauty of imperfection"/>
<meta name="twitter:description" content="
  


Perfection is not something one can truly achieve, so it’s very smart that one of the best meditation services called Headspace is using an imperfect dot as their brand logo.

If you ever used their iOS app, you can notice how their dot slightly deforms, captivating your focus.

When it comes to graphics, if you are able to cheat (if user can’t tell the difference) and make tech stuff easier, just do it.
"/>
<meta name="twitter:site" content="@merowing_"/>
<meta name="twitter:creator" content="@merowing_"/>



  <link rel="canonical" href="http://merowing.info/2015/11/the-beauty-of-imperfection/">

  <link href='//fonts.googleapis.com/css?family=Merriweather:900,900italic,300,300italic' rel='stylesheet' type='text/css'>
  <link href='//fonts.googleapis.com/css?family=Lato:900,300' rel='stylesheet' type='text/css'>
  <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css" rel="stylesheet">


  
  <link href="/css/prism.css" rel="stylesheet" />
  <link href="/css/about.css" rel="stylesheet" />

  <link rel="stylesheet" type="text/css" href="http://merowing.info/css/combined-min.css">
</head>
<body class="">

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js" type="text/javascript"></script>
<div class="site-wrap">
    <header class="site-header px2 px-responsive">
    <div class="mt2 wrap">
        <div class="measure">
            <nav class="site-nav left">
                <a href="http://merowing.info" class="site-title">Krzysztof Zabłocki</a>
            </nav>
            <nav class="site-nav right">
                <a href="/hire/">About Me</a>
<a href="/speaking/">Speaking</a>


</form>

            </nav>
            <div class="clearfix"></div>
        </div>
    </div>
</header>

<div class="wrap measure center">
    <nav class="social-icons icons">
        
<a class="fa fa-twitter" href="https://twitter.com/merowing_"></a>



<a class="fa fa-github" href="https://github.com/krzysztofzablocki"></a>



<a class="fa fa-facebook" href="https://facebook.com/krzysztofzablocki"></a>



<a class="fa fa-linkedin" href="https://linkedin.com/pub/krzysztof-zab%c5%82ocki/26/200/442"></a>


<a class="fa fa-rss" href="/index.xml"></a>

    </nav>
</div>
    <div class="post p2 p-responsive wrap" role="main">
        <div class="measure">
            <div class="post-header mb2">
                <h1 class="h2 py2">The beauty of imperfection</h1>
                <span class="post-meta">Nov 24, 2015</span>
                
                <span class="post-meta right"><i class="fa fa-clock-o"></i> <em>4 minute read</em></span>
                
                <br>

                
            </div>

            
            <div class="center playground">
                <a href="/2015/12/ImperfectCircle.playground.zip">
                    <img src="http://merowing.info/2015/01/playgrounds.png"/>
                    <span>Download as Playground.</span>
                </a>
            </div>
            <br/>
            

            

            <article class="post-content">
                

<video autoplay loop>
  <source src="/2015/12/dot-animated.mov" type="video/mp4">
</video>

<p>Perfection is not something one can truly achieve, so it’s very smart that one of the best meditation services called <a href="https://www.headspace.com">Headspace</a> is using an imperfect dot as their brand logo.</p>

<p>If you ever used their iOS app, you can notice how their dot slightly deforms, captivating your focus.</p>

<p>When it comes to graphics, if you are able to cheat (if user can’t tell the difference) and make tech stuff easier, just do it.</p>

<h2 id="a-note-on-original-implementation:2ef054e1986c78a07cd2936c4a6d6e4a">A note on original implementation</h2>

<p>The original implementation of Headspace app was using Quadrilateral, there is now a <a href="https://github.com/hfossli/AGGeometryKit/">library for iOS for doing that</a>, but I no longer think it’s neccesary for the intentend effect, it makes things more complex that they need to be.</p>

<p>We can achieve same effect with little code.</p>

<h2 id="implementation:2ef054e1986c78a07cd2936c4a6d6e4a">Implementation</h2>

<p>The first thing I wanted to do is start with slightly deformed circle, so I’ve opened <a href="https://paintcodeapp.com">PaintCode</a>:</p>

<ul>
<li>draw a circle</li>
<li>edit bezier and moved couple of vertices</li>
<li>end up with:</li>
</ul>

<p>
<figure class="center">
    
        <img src="/2015/12/blob.png"  />
    
    
</figure>

</p>

<p>and the generated code:</p>

<pre><code class="language-swift">func createBlobShape() -&gt; UIBezierPath {
  let ovalPath = UIBezierPath()
  ovalPath.moveToPoint(CGPointMake(13.71, -29.07))
  ovalPath.addCurveToPoint(CGPointMake(27.92, -14), controlPoint1: CGPointMake(20.64, -25.95), controlPoint2: CGPointMake(24.57, -20.72))
  ovalPath.addCurveToPoint(CGPointMake(33, 0.5), controlPoint1: CGPointMake(30.08, -9.68), controlPoint2: CGPointMake(33, -4.64))
  ovalPath.addCurveToPoint(CGPointMake(20.82, 26), controlPoint1: CGPointMake(33, 10.93), controlPoint2: CGPointMake(27.47, 17.84))
  ovalPath.addCurveToPoint(CGPointMake(0, 33), controlPoint1: CGPointMake(16.02, 31.88), controlPoint2: CGPointMake(7.63, 33))
  ovalPath.addCurveToPoint(CGPointMake(-16.72, 28.33), controlPoint1: CGPointMake(-6.21, 33), controlPoint2: CGPointMake(-11.89, 31.29))
  ovalPath.addCurveToPoint(CGPointMake(-23.86, 22), controlPoint1: CGPointMake(-19.59, 26.57), controlPoint2: CGPointMake(-22.22, 24.28))
  ovalPath.addCurveToPoint(CGPointMake(-28, 17), controlPoint1: CGPointMake(-25.19, 20.16), controlPoint2: CGPointMake(-26.74, 19.46))
  ovalPath.addCurveToPoint(CGPointMake(-33, 0.5), controlPoint1: CGPointMake(-30.24, 12.61), controlPoint2: CGPointMake(-33, 5.74))
  ovalPath.addCurveToPoint(CGPointMake(-23.86, -23), controlPoint1: CGPointMake(-33, -9.63), controlPoint2: CGPointMake(-31.23, -17.04))
  ovalPath.addCurveToPoint(CGPointMake(-4.57, -33), controlPoint1: CGPointMake(-18.17, -27.6), controlPoint2: CGPointMake(-12.51, -33))
  ovalPath.addCurveToPoint(CGPointMake(13.71, -29.07), controlPoint1: CGPointMake(0.32, -33), controlPoint2: CGPointMake(9.53, -30.95))
  ovalPath.closePath()
  return ovalPath
}
</code></pre>

<p><br/>
Now keep in mind this is <strong>way more deformed</strong> that what you&rsquo;d do for replicating Headspace dot, but I wanted to make it more obvious for the article.</p>

<p>Deform it less to get a more subtle effect.</p>

<p>Next thing to do was drawing that in iOS, for that as always I’ve used my favourite layer called CAShapeLayer</p>

<p>I set it’s shape to the path generated from PaintCode and made sure it’s centered correctly:</p>

<pre><code class="language-swift">let blob = CAShapeLayer()
let blobShape = createBlobShape()
blob.path = blobShape.CGPath
blob.frame = blobShape.bounds
blob.anchorPoint = CGPointMake(0, 0)
blob.fillColor = UIColor.orangeColor().CGColor

var view = UIView(frame: CGRectMake(0, 0, 640, 480))
view.backgroundColor = UIColor.grayColor().colorWithAlphaComponent(0.8)
XCPlaygroundPage.currentPage.liveView = view
</code></pre>

<p>and already I’ve a simple deformed circle in my playground:</p>

<p>
<figure class="center">
    
        <img src="/2015/12/dot.png"  />
    
    
</figure>

</p>

<p>Now we just need to make it animate with time, so we get the desired slight deformation effect.</p>

<h3 id="animation:2ef054e1986c78a07cd2936c4a6d6e4a">Animation</h3>

<p>We can use CADisplayLink to implement our animation manually. To use CADisplayLink in our playground, we&rsquo;ll add a simple wrapper for block based animation:</p>

<pre><code class="language-swift">class Animator {
  class TargetProxy {
      init (target: Animator) {
          self.target = target
      }
      
      weak var target: Animator!
      var totalTime: NSTimeInterval = 0
      
      @objc func onFire (dl: CADisplayLink) {
          totalTime += dl.duration
          target.block(totalTime)
      }
  }
  
  
  private lazy var displayLink: CADisplayLink = {
      return CADisplayLink(target: TargetProxy(target: self), selector: &quot;onFire:&quot;)
  }()
  private let block: NSTimeInterval -&gt; Void

  init (block: NSTimeInterval -&gt; Void) {
      self.block = block
      displayLink.addToRunLoop(NSRunLoop.mainRunLoop(), forMode: NSRunLoopCommonModes)
  }
  
  deinit {
      displayLink.invalidate()
  }
}
</code></pre>

<p>Animator can be created with a block accepting total time that has passed from it&rsquo;s creation, quite simple.</p>

<p>We compose our animation of 2 simple matrix transforms:
- Rotation
- Scale
- Skew</p>

<p>Rotation itself is too easy to spot, but when we throw skewing the effect is more interesting. Give it a try and play with the values.</p>

<pre><code class="language-swift">let dl = Animator {
  let skewBaseTime = $0 * 0.3

  let rotation = CATransform3DMakeRotation(CGFloat(acos(cos(skewBaseTime))), 0, 0, 1)
  let upscale = 5.0
  let scaleAdjustment = 0.1
  let scale = CATransform3DMakeScale(CGFloat(upscale + abs(sin(skewBaseTime) * scaleAdjustment)), CGFloat(upscale + abs(cos(skewBaseTime) * scaleAdjustment)), 1)
  
  let skewTransform = CGAffineTransformMake(1.0, 0.0, CGFloat(cos(skewBaseTime + M_PI_2) * 0.1), 1.0, 0.0, 0.0)
  CATransaction.begin()
  CATransaction.setValue(kCFBooleanTrue, forKey: kCATransactionDisableActions)
  view.layer.sublayerTransform = CATransform3DConcat(CATransform3DMakeAffineTransform(skewTransform), scale)
  blob.transform = rotation
  CATransaction.commit()
}
</code></pre>

<ul>
<li>We upscale the dot to make it easier to see</li>
<li>Apply some small offset scaling in both dimmension</li>
<li>Apply skew transformation to make it even more deformed (could probably get rid of this part)</li>
</ul>

<p>Now why are we using sublayerTransform and not just apply everything on the blob?</p>

<p>Because it will allow you to add other views and make them deform with the blob, while rotating only the blob itself.
E.g. in Headspace that could be play / pause button.</p>

<p>So adding a Play button from Noun Project (created by Mike Ashley):</p>

<pre><code class="language-swift">let playImageView = UIImageView(image: UIImage(named: &quot;play&quot;))
playImageView.transform = CGAffineTransformMakeScale(0.05, 0.05)
playImageView.center = blob.position
view.addSubview(playImageView)
</code></pre>

<p>We achieve a play icon deforming slightly while the dot is significant (for real app it would be much less exaggerated)</p>

<video autoplay loop>
  <source src="/2015/12/play-animated.mov" type="video/mp4">
</video>

<h2 id="conclusion:2ef054e1986c78a07cd2936c4a6d6e4a">Conclusion</h2>

<p>The total implementation fit 100 lines of code, the original implementation using Quadrilateral&rsquo;s was probably around this size.</p>

<p>Keeping stuff simpler will make your life easier, and when it comes to graphics you can often cheat and your user won&rsquo;t care as they won&rsquo;t be able to tell the difference.</p>

            </article>
            <a href="https://twitter.com/merowing_" class="twitter-follow-button" data-show-count="true"
               data-size="medium"></a>
            <br/>

            <div class="social-icons">

                <p>Want to support my writing and open source work? <a href="https://www.patreon.com/merowing">Become a Patreon</a><p>
                <p>Need help with iOS project? <a href="/hire">You can hire me.</a></p>
                <p>Share this post:</p>
                <div class="addthis_sharing_toolbox left" data-url="http://merowing.info/2015/11/the-beauty-of-imperfection/"
                     data-title="The beauty of imperfection"></div>
            </div>
            <div class="clearfix"></div>

            </br>
            
            </br>
            </br>

            <p class="post-meta">tags:&nbsp;
                
                
                <a href="http://merowing.info/tags/ios">iOS</a>
                
                ,&nbsp;
                <a href="http://merowing.info/tags/tutorial">Tutorial</a>
                
                ,&nbsp;
                <a href="http://merowing.info/tags/experiments">Experiments</a>
                
                ,&nbsp;
                <a href="http://merowing.info/tags/uix">UIX</a>
                
                ,&nbsp;
                <a href="http://merowing.info/tags/animation">Animation</a>
                
            </p>
        </div>
    </div>
</div>

<script>!function (d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0];
    if (!d.getElementById(id)) {
        js = d.createElement(s);
        js.id = id;
        js.src = "//platform.twitter.com/widgets.js";
        fjs.parentNode.insertBefore(js, fjs);
    }
}(document, "script", "twitter-wjs");</script>





<footer class="footer">
    <div class="p2 wrap">
        <div class="measure mt1 center">
            <nav class="social-icons icons">
    
<a class="fa fa-twitter" href="https://twitter.com/merowing_"></a>



<a class="fa fa-github" href="https://github.com/krzysztofzablocki"></a>



<a class="fa fa-facebook" href="https://facebook.com/krzysztofzablocki"></a>



<a class="fa fa-linkedin" href="https://linkedin.com/pub/krzysztof-zab%c5%82ocki/26/200/442"></a>


<a class="fa fa-rss" href="/index.xml"></a>

</nav>

            <small>
                Krzysztof Zabłocki <br/>
                Copyright &#169; 2012-2015<br>
                Powered by <a href="http://gohugo.io/" target="_blank">Hugo</a> &amp; based on <a
                    href="https://github.com/azmelanar/hugo-theme-pixyll" target="_blank">Pixyll</a>
            </small>
        </div>
    </div>
</footer>

<script src="/js/prism.js"></script>
<script src="/js/carousel.js"></script>




<script src="/lightgallery/js/lightgallery.min.js"></script>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-mousewheel/3.1.13/jquery.mousewheel.min.js"></script>


<script src="/lightgallery/js/lg-thumbnail.min.js"></script>
<script src="/lightgallery/js/lg-fullscreen.min.js"></script>

<script type="text/javascript">
    $(document).ready(function () {
        $('.lightgallery').lightGallery({
            thumbnail: true
        });
    });
</script>



<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-29400340-1', 'auto');
  ga('send', 'pageview');

</script>



<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-532368630eb37492" async="async"></script>
<script type="text/javascript">
var addthis_share = addthis_share || {}
addthis_share = {
	passthrough : {
		twitter: {
			via: "merowing_"
		}
	}
}
</script>
</body>
</html>

